<body>
<pre>

<div class="timershrink" id="timerflare" title="Spawns 4 high-speed missiles that target the nearest vulnerable enemy but explodes in .5 seconds. Cooldown = 7 seconds Costs 20 energy">X</div>
<div class="timershrink" id="timershrink" title="Shrinks down 50% for 5s and a cooldown of 5s Costs 15 energy">Z</div>
<p id="speedsys" class="speedsys">1| Speed:</p>
<p id="leveldetect" class="leveldetect">Level: 1</p>
<p id="energy" class="energy">2| Energy:</p>
<p id="regen" class="regen">3| Regen:</p>
</pre>
  <div id="evader">

  </div>
  <div id="affected">
    <div class="sys" id="sys">
      <button class="runner" id="runner"></button>
    </div>
    <div class="hidden" id="hidden">
      <p class="custom" id="custom">&gt;_</p>

      <code class="hiddenp" id="hiddenp">&gt;?
<p class="non" id="no">
&gt;&gt;&gt;setTimeout(() => {
    window.close();
}, 2000);</p>
<p class="non" id="no1">
&gt;&gt;&gt;HAHAHAHA
</p>
<p class="non" id="no2">
&gt;&gt;&gt;YOU GOT CLAPPED
</p>
<p class="non" id="no3">
&gt;&gt;&gt;YOU GOT CLAPPEDD
</p>
<p class="non" id="no4">
&gt;&gt;&gt; Terminating...
</p>
</code>
    </div>
</body>
<p class="textother"></p>
<div class="laserball" id="laserball">&gt;:D

  <div class="laser" id="laser"></div>

  <div class="lasertrigger" id="laser16"></div>

</div>
</div>
<style>
.flarhom {
  position: absolute;
  top: 50%;
  left: 50%;
  border-radius: 100%;
  padding: 15px;
  background-color: #080100;
}
@keyframes implode {
  0% { transform: scale(1); opacity: 1; }
  100% { transform: scale(0); opacity: 0.5; }
}

@keyframes flyOut {
  0% { transform: scale(0.4); opacity: 1; }
  100% { transform: scale(0.9); opacity: 0; }
}

.imploding {
  animation: implode 0.25s ease-in forwards;
}

.boomShard {
  position: absolute;
  width: 50px;
  height: 50px;
  border-radius: 50%;
  background-color: cyan;
  animation: flyOut 0.3s ease-out forwards;
}
  .energy {
    position: absolute;
    top: 50px;
    left: 10px;
  }

  .regen {
    position: absolute;
    top: 65px;
    left: 10px;
  }

  .leveldetect {
    position: absolute;
    top: 20px;
    left: 10px;
  }

  @keyframes cpulse {
    0% {
      box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.4);
    }

    70% {
      box-shadow: 0 0 0 30px rgba(255, 255, 255, 0);
    }

    100% {
      box-shadow: 0 0 0 0 rgba(255, 255, 255, 0);
    }
  }
.cpulse2 {
  animation: cpulse 1s ease-in-out;
}
  @keyframes sheepulse {
    0% {
      box-shadow: 0 0 0 10px rgba(245, 73, 39, 0.7);
      transform: rotate(0deg);

    }


    70% {
      box-shadow: 0 0 0 50px rgba(245, 73, 39, 0.5);
      transform: rotate(380deg);
    }

    100% {
      box-shadow: 0 0 0 30px rgba(168, 76, 57, 0.2);
      transform: rotate(0deg);
    }
  }
  .sheepu {
    animation: sheepulse .5s ease-in-out;
  }
  

  @keyframes screenshake {

    0%,
    100% {
      transform: translate3d(0, 0, 0);
      /* Start and end at original position */
    }

    20%,
    60% {
      transform: translate3d(-5px, 0, 0);
      /* Move left */
    }

    40%,
    80% {
      transform: translate3d(5px, 0, 0);
      /* Move right */
    }

    /* Optional: Add vertical or rotational movement for more complex shake */
    30% {
      transform: translate3d(0, -3px, 0) rotate(1deg);
      /* Move up slightly and rotate */

    }

    70% {
      transform: translate3d(0, 3px, 0) rotate(-1deg);
      /* Move down slightly and rotate */
    }
  }

  @keyframes sepulse {
    0% {
      box-shadow: 0 0 10px 30px #701705;
      border-radius: 100px;
      opacity: .3;

    }

    10% {
      opacity: .4;

    }

    15% {
      opacity: .5;
    }

    20% {
      opacity: .6;
    }

    25% {
      opacity: .7;
    }

    30% {
      opacity: .8;
    }

    70% {
      box-shadow: 0 10px 0 5000px rgba(255, 255, 255, 0.4);
      border-radius: 100px;

    }

    100% {
      box-shadow: 0 0 0 25px #701705;
      border-radius: 100px;

    }
  }

  @keyframes onecycle {
    0% {
      transform: rotate(0deg);
    }

    100% {
      transform: rotate(360deg);
    }
  }

  .timershrink {
    color: white;
    width: 20px;
    height: 20px;
    background-color: green;
    position: absolute;

    top: 10px;
    border-color: black;
    border-radius: 25%;
    border-style: solid;
    border-width: 0px;
    font-family: Arial, Sans-Serif;

    /*  animation: timeout 1s linear 5;*/
  }

  #timershrink {
    left: 10px;
  }

  #timerflare {
    display: none;
    left: 2.27em;
  }

  #evader {
    width: 45px;
    height: 45px;
    background-color: dodgerblue;
    position: absolute;
    top: 50%;
    left: 50%;

    border-radius: 300px;
    text-align: center;
    display: flex;
    /* Make the div a flex container */
    justify-content: center;
    /* Horizontally center its content */
    align-items: center;
    /* Vertically center its content */
    border-radius: 100px;
  }

  .laserball {
    display: none;
    position: absolute;
    width: 30px;
    height: 35px;
    background-color: #2795F5;
    border-radius: 0%;
    top: 50%;
    left: 50%;
    color: red;
    font-weight: bold;
    box-shadow: 0 0 10px #27F5AD;
  }

  .lasertrigger {
    opacity: .9;
    display: none;
    position: absolute;
    width: 40px;
    height: 1000px;

    background: linear-gradient(to bottom, red, transparent);
    top: 50%;
    left: -20%;
    box-shadow: 0 0 20px #C73214;
    animation: sepulse .250s linear;
    border-radius: 35px;
  }

  .laser {
    display: none;
    position: absolute;
    width: 25px;
    height: 1000px;
    background: linear-gradient(to bottom, #27F5AD, transparent);
    top: 50%;
    left: 8.5%;
    box-shadow: 0 0 20px #27F5AD;
    animation: cpulse .250s linear;
    border-radius: 10px;
  }

  .non {
    display: none;
  }

  @keyframes textother {
    0% {
      opacity: 1;
    }

    100% {
      opacity: 0;
    }
  }

  @keyframes opacity {
    0% {
      opacity: 1;
    }

    10% {
      opacity: 0.6;
    }

    25% {
      opacity: 0.8;
    }

    35% {
      opacity: 0.6;
    }

    50% {
      opacity: 0.8;
    }

    60% {
      opacity: 0.6;
    }

    75% {
      opacity: 0.8;
    }

    85% {
      opacity: 0.6;
    }

    100% {
      opacity: 1;
    }
  }

  .custom {
    display: none;
    text-align: left;
    font-size: 23px;
    color: #27F5AD;
  }

  .hidden {
    display: none;
    background-color: #08290A;
    border-radius: 25px;
    border-color: #27F5AD;
    border-width: 1px;
    border-style: solid;
    padding: 20px;
    animation: opacity 5s linear alternate infinite;
  }

  .hiddenp {
    display: none;
    text-align: left;
    display: none;
    font-size: 15px;
    color: #27F5AD;
    ;
    animation: opacity 5s linear alternate infinite;
    padding: 20px;
    background-color: black;
    border-radius: 5px;
  }

  @keyframes rotatiger {
    0% {
      transform: rotate(0deg);
    }

    360% {
      transform: rotate(360deg);
    }
  }

  body {
    background-color: #7486B8;

    text-align: center;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
  }

  .screenshake {
    animation: screenshake .5s linear infinite;
    transform: translate3d(0, 0, 0);
    backface-visibility: hidden;
    perspective: 1000px;
  }

  .runner {

    display: none;
    box-shadow: 0 0 40px 10px #280C97;
    border-color: #425BEB;
    border-width: 23px;
    border-radius: 1000px;
    background-image: linear-gradient(45deg, #27F5E0, #27F5A9, #375E5A);
    clip-path: polygon(50% 0%, 93.3% 25%, 93.3% 75%, 50% 100%, 6.7% 75%, 6.7% 25%);
    padding: 40px;

  }

  .sys {
    display: none;
    filter: drop-shadow(0px 0px 10px #2C05F7);
    position: absolute;
    border-color: #425BEB;
    border-width: 20px;
    border-radius: 1000px;

    padding: 140px;

    opacity: 1;
  }

  @keyframes rotating {
    0% {
      transform: rotate(0deg);
    }

    30% {
      transform: rotate(90deg);
    }

    70% {
      transform: rotate(100deg);
    }

    85% {
      transform: rotate(180deg);
    }

    99% {
      transform: rotate(380deg);
    }

    100% {
      transform: rotate(3721deg);
    }
  }

  @keyframes pulse {
    0% {
      box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.4);
    }

    70% {
      box-shadow: 0 0 0 30px #173054;
    }

    100% {
      box-shadow: 0 0 0 0 rgba(255, 255, 255, 0);
    }
  }

  .sys:hover {
    animation: pulse 0.3s ease-in-out infinite;
  }

  .flarnum {
 
    position: absolute;
    width: 20px;
    height: 20px;
    background-color: #F70505;
    border-radius: 200px;
  }

  .flare {
    visibility: visible;
    display: block;
    background-color: blue;

    animation-name: pulse, rotating;
    animation-duration: 0.3s;

    padding: 13px;
    border-radius: 100px;
    border-color: #09EDB4;
    border-width: 7;
  }

  .gunner {
    position: absolute;
    visibility: visible;
    display: block;
    background-color: blue;
    border-width: 5px;
    background-image: linear-gradient(45deg, #375E5A #27F5A9, #375E5A);
    padding: 10px;
    border-radius: 20px;

  }

  @keyframes timeout {
    0% {
      border-width: 4px;
      border-color: black;
    }

    100% {
      border-width: 4px;
      border-color: black;
    }
  }

  #speedsys {
    left: 10px;
    top: 35px;
    position: absolute;
  }
  .boomer {
    border-radius: 100%;
    border-style: solid;
    border-width: 0px;
  }
</style>

<script>

let points = 1;
let pointT = 0;

    function collision(a, b) {
      return (
        a.left < b.right &&
        a.right > b.left &&
        a.top < b.bottom &&
        a.bottom > b.top)
    }
    function collision1(a, b) {
      collision(a, b);
    }
  function nextInitialize() {
    let regen = document.getElementById("regen")
    let energy = document.getElementById("energy")
    let gun;
    let increaseRate = 1;
    let currentEnergy = 30;
    let maximumE = 30;
    let defualtspeed = 10;
    let speed = 0;
    function reload() {

      rect = evader.getBoundingClientRect();
      if (rect.right > window.innerWidth || rect.bottom > window.innerHeight || rect.left < 0 || rect.top < 0) {
        outter = true;
      }
      requestAnimationFrame(reload);
    }
    requestAnimationFrame(reload);
    let speex;
    function reco() {
      speex = defualtspeed - 4
      requestAnimationFrame(reco)
    }
    reco()

    function regenfunct() {

      let increaseToScale = increaseRate / 100
      if (maximumE > currentEnergy) {
        setTimeout(() => {
          currentEnergy = (currentEnergy + increaseToScale);
        }, 100)
      } else if (maximumE < currentEnergy) {
        currentEnergy = maximumE;
      }

      regen.textContent = `3| Regen: ${increaseRate.toFixed(1)}`
      let unFloat = Math.trunc(currentEnergy)
      energy.textContent = `2| Energy: ${unFloat}/${maximumE}`;
      requestAnimationFrame(regenfunct)
    } requestAnimationFrame(regenfunct)
    regenfunct()
    let initOne = false
    let initTwo = false
    let initThree = false

    const cshrink = document.getElementById("timershrink");

    document.body.addEventListener("keydown", () => {
      if (event.key === "x" && points >= 5) {
        if (!spawned && currentEnergy >= 20) {
          countdown2()
          setTimeout(() => {
           cflare.style.backgroundColor = "green"
           cflare.textContent = "X"
           cflare.classList.remove("cpulse2")
        }, 7000)
          const one = document.createElement("div")
          const two = document.createElement("div")
          const three = document.createElement("div")
          const four = document.createElement("div")

          one.classList.add("flarnum")
          two.classList.add("flarnum")
          three.classList.add("flarnum")
          four.classList.add("flarnum")

          document.body.appendChild(one)
          document.body.appendChild(two)
          document.body.appendChild(three)
          document.body.appendChild(four)

          const centerX = rect.left + (rect.width / 2) - 10;
          const centerY = rect.top + (rect.height / 2) - 10;
          const spawnDistance = 50;

          one.style.left = `${centerX - spawnDistance}px`;
          one.style.top = `${centerY}px`;

          two.style.left = `${centerX + spawnDistance}px`;
          two.style.top = `${centerY}px`;

          three.style.left = `${centerX}px`;
          three.style.top = `${centerY - spawnDistance}px`;

          four.style.left = `${centerX}px`;
          four.style.top = `${centerY + spawnDistance}px`;
          currentEnergy -= 20;
          spawned = true;
          setTimeout(() => {
            spawned = false;
          }, 7000)

          flarnums.push(one, two, three, four);
          setTimeout(() => {
            one.classList.remove("flarnum")
            two.classList.remove("flarnum")
            three.classList.remove("flarnum")
            four.classList.remove("flarnum")
            document.body.removeChild(one)
            document.body.removeChild(two)
            document.body.removeChild(three)
            document.body.removeChild(four)
          }, 500)
        }
      }

      if (event.key === "2" && !initTwo && pointT >= 1) {
        maximumE = maximumE + 5;
        pointT--;
        initTwo = true;
        setTimeout(() => {
          initTwo = false;
        }, 100)
      }
      if (event.key === "1" && !initOne && pointT >= 1) {
        defualtspeed += 0.5

        pointT--;
        initOne = true;
        setTimeout(() => {
          initOne = false;
        }, 100)
      }
      if (event.key === "3" && !initThree && pointT >= 1) {
        pointT--;
        increaseRate += Math.round(.2 * 10) / 10;

        initThree = true;
        setTimeout(() => {
          initThree = false;
        }, 100)
      }
    })
    let lD = document.getElementById('leveldetect');
    let token;
    const laser1 = document.getElementById("laser2");

    const laserball = document.getElementById("laserball");
    function lazer() {
      laserball.style.display = "block"

      laser16.style.display = "block";

      setTimeout(() => {
        laser16.style.display = "none";
        laser.style.display = "block";
        laserball.style.transform = "rotate(36deg)";
        laser.style.opacity = 0.4

      }, 1125);
      setTimeout(() => {

        laserball.style.transform = "rotate(54deg)";
        laser.style.opacity = 0.6

      }, 1250);
      setTimeout(() => {

        laserball.style.transform = "rotate(72deg)";
        laser.style.opacity = 0.8

      }, 1375);
      setTimeout(() => {
        laser.style.display = "none";
        laser16.style.display = "block";
        laserball.style.transform = "rotate(90deg)";////

      }, 1500);
      setTimeout(() => {
        laser16.style.display = "none";
        laser.style.display = "block";
        laserball.style.transform = "rotate(108deg)";
        laser.style.opacity = 0.2

      }, 2625);
      setTimeout(() => {

        laserball.style.transform = "rotate(126deg)";
        laser.style.opacity = 0.4

      }, 2750);
      setTimeout(() => {

        laserball.style.transform = "rotate(144deg)";
        laser.style.opacity = 0.6

      }, 2875);
      setTimeout(() => {

        laserball.style.transform = "rotate(162deg)";
        laser.style.opacity = 0.8
      }, 3000);
      setTimeout(() => {
        laser.style.display = "none";
        laser16.style.display = "block";
        laserball.style.transform = "rotate(180deg)";///
      }, 3125);
      setTimeout(() => {
        laser16.style.display = "none";
        laser.style.display = "block";
        laserball.style.transform = "rotate(198deg)";
        laser.style.opacity = 0.2
      }, 4250);
      setTimeout(() => {

        laserball.style.transform = "rotate(216deg)";
        laser.style.opacity = 0.4
      }, 4375);
      setTimeout(() => {
        laser13.style.display = "none";
        laser14.style.display = "block";
        laserball.style.transform = "rotate(234deg)";
        laser.style.opacity = 0.6
      }, 4500);
      setTimeout(() => {

        laserball.style.transform = "rotate(252deg)";
        laser.style.opacity = 0.8
      }, 4625);
      setTimeout(() => {
        laser.style.display = "none";
        laser16.style.display = "block";
        laserball.style.transform = "rotate(270deg)";///
      }, 4750);
      setTimeout(() => {
        laser16.style.display = "none";
        laser.style.display = "block";
        laserball.style.transform = "rotate(288deg)";
        laser.style.opacity = 0.2
      }, 5875);
      setTimeout(() => {

        laserball.style.transform = "rotate(306deg)";
        laser.style.opacity = 0.4
      }, 6000);
      setTimeout(() => {

        laserball.style.transform = "rotate(324deg)";
        laser.style.opacity = 0.6
      }, 6125);
      setTimeout(() => {

        laserball.style.transform = "rotate(342deg)";
        laser.style.opacity = 0.8
      }, 6250);
      setTimeout(() => {
        laser.style.display = "none";
        laser16.style.display = "block";
        laserball.style.transform = "rotate(360deg)"; ///
        lazer()
      }, 6370);

    }
    const cflare = document.getElementById("timerflare")
    const speedsys = document.getElementById("speedsys")
    function countdown() {
      cshrink.textContent = "5"
      setTimeout(() => {
        cshrink.textContent = "4"
      }, 1000);
      setTimeout(() => {
        cshrink.textContent = "3"
      }, 2000);
      setTimeout(() => {
        cshrink.textContent = "2"
      }, 3000);
      setTimeout(() => {
        cshrink.textContent = "1"
      }, 4000);
      setTimeout(() => {
        cshrink.textContent = "5"
      }, 5000);
      setTimeout(() => {
        cshrink.textContent = "4"
      }, 6000);
      setTimeout(() => {
        cshrink.textContent = "3"
      }, 7000);
      setTimeout(() => {
        cshrink.textContent = "2"
      }, 8000);
      setTimeout(() => {
        cshrink.textContent = "1"
      }, 9000);
    }
function countdown2() {

  for (let i = 7; i >= 0; i--) {
    cflare.style.backgroundColor = "blue"
    setTimeout(() => {
      cflare.classList.add("cpulse2")
      cflare.textContent = i;

    }, 1000 * (7 - i));
  }
}

    const evader = document.getElementById('evader');
    let outter = false;
    let rect;
    let token1;
    let rectG;

 const guns = []

 const flarnums = []; 
const flarnumSize = 20; 
const flarnumSpeed = 20; 

function updateFlarnums() {
  for (let i = 0; i < flarnums.length; i++) {
    const el = flarnums[i];
    const currentLeft = parseFloat(el.style.left) || el.getBoundingClientRect().left;
    const currentTop = parseFloat(el.style.top) || el.getBoundingClientRect().top;

    const gunhyp = [];
    guns.forEach((em) => {
      const emrect = em.getBoundingClientRect();
      const distance = Math.hypot(
        (emrect.left + emrect.width / 2 - flarnumSize / 2) - currentLeft,
        (emrect.top + emrect.height / 2 - flarnumSize / 2) - currentTop
      );
      gunhyp.push({ em, distance });
      document.querySelectorAll(".flarnum").forEach(florrr => {
        const florer = florrr.getBoundingClientRect();
        if (collision(emrect, florer)) {
          em.style.display = "none"
          const rotateInterval = Math.random() * (360 - (-360)) + (-360);
          const boomer = document.createElement("div")
          boomer.classList.add("boomer", "imploding")
          boomer.style.backgroundColor = "red"
          boomer.style.position = "absolute"
          boomer.style.width = "1px"
          boomer.style.height = "1px"
          boomer.style.left = `${florer.left}px`
          boomer.style.top = `${florer.top}px`
          boomer.style.transform = `rotate(${rotateInterval}deg)`

          document.body.appendChild(boomer)
          setTimeout(() => {
  const centerX = florer.left + 12; 
  const centerY = florer.top + 12;
  
  for (let i = 0; i < 6; i++) {
    const angle = (Math.PI * 1 / 3) * i;
    const shard = document.createElement("div");
    shard.classList.add("boomShard");

    shard.style.left = `${centerX}px`;
    shard.style.top = `${centerY}px`;

    document.body.appendChild(shard);

    const distance = 80;
    const dx = Math.cos(angle) * distance;
    const dy = Math.sin(angle) * distance;


    shard.animate([
      { transform: "translate(0, 0) scale(0.4)", opacity: 1 },
      { transform: `translate(${dx}px, ${dy}px) scale(0.9)`, opacity: 0 }
    ], {
      duration: 500,
      easing: "ease-out",
      fill: "forwards"
    });

    setTimeout(() => {
      document.body.removeChild(shard);
    }, 550);
  }

  // remove the main boomer
  document.body.removeChild(boomer);
}, 150);
          
          
        }
      });
      
    });

    gunhyp.sort((a, b) => a.distance - b.distance);
    let closestgun = (gunhyp[0].em).getBoundingClientRect(); 


    const targetLeft = closestgun.left + (closestgun.width / 2) - (flarnumSize / 2);
    const targetTop = closestgun.top + (closestgun.height / 2) - (flarnumSize / 2);

    const dx = targetLeft - currentLeft;
    const dy = targetTop - currentTop;
    const dist = Math.hypot(dx, dy) || 1;
    const stepX = (dx / dist) * flarnumSpeed;
    const stepY = (dy / dist) * flarnumSpeed;

    el.style.left = (currentLeft + stepX) + 'px';
    el.style.top = (currentTop + stepY) + 'px';
    
  }
  requestAnimationFrame(updateFlarnums);
}
requestAnimationFrame(updateFlarnums);
    let shrink = false;
    let spawned = false;
    document.addEventListener('DOMContentLoaded', () => {
      const keys = {
        ArrowUp: false,
        ArrowDown: false,
        ArrowLeft: false,
        ArrowRight: false,
        Shift: false,
        z: false
      };
      if (keys) {
        speed = 0;
      }

      document.addEventListener('keydown', (e) => {
        if (keys.hasOwnProperty(e.key)) {
          keys[e.key] = true;
        }

        if (e.key === "Shift") {
          evader.style.backgroundColor = "#27D6F5"
        }
        if (e.key === "z" && shrink === false && currentEnergy >= 15) {
          countdown();
          cshrink.style.display = "block"
          evader.style.width = "20px";
          evader.style.height = "20px";
          shrink = true;
          cshrink.style.borderWidth = "2px"
          cshrink.style.borderColor = "black"
          cshrink.style.backgroundColor = "blue"
          currentEnergy -= 15;
          setTimeout(() => {

            cshrink.style.borderWidth = "0px"
            evader.style.width = "45px";
            evader.style.height = "45px";
            //
            cshrink.animate([
              { boxShadow: "0 0 0 0 rgba(255, 255, 255, 0.4)" },
              { boxShadow: "0 0 0 30px rgba(255, 255, 255, 0)" },
              { boxShadow: "0 0 0 0 rgba(255, 255, 255, 0)" }
            ], {
              duration: 1000,
              easing: 'ease-in-out',
              iterations: '5',
            });
            //
            setTimeout(() => {
              cshrink.style.background = "green"
              cshrink.style.borderWidth = "0px"
              cshrink.textContent = "Z"
              shrink = false;
            }, 5000);

          }, 5000);

        }
      });

      document.addEventListener('keyup', (e) => {
        if (keys.hasOwnProperty(e.key)) {
          keys[e.key] = false;
        }
        if (e.key === 'Shift') {
          evader.style.backgroundColor = "dodgerblue"
        }
      });

      let step2 = false;
      function alleyoop() {
        let evaderX = evader.offsetLeft;
        let evaderY = evader.offsetTop;

        // Calculate potential new positions
        let newX = evaderX;
        let newY = evaderY;

        // Determine the new speed
        if (keys.Shift && (keys.ArrowUp || keys.ArrowDown || keys.ArrowLeft || keys.ArrowRight)) {
          speed = speex;
        } else if (!keys.ArrowUp && !keys.ArrowDown && !keys.ArrowLeft && !keys.ArrowRight) {
          speed = 0;
        } else {
          speed = defualtspeed;

        }

        // Update position based on key presses and check boundaries
        if (keys.ArrowUp) {
          newY = evaderY - speed;
          if (newY >= 0) {
            evaderY = newY;
          }
        }
        if (keys.ArrowDown) {
          newY = evaderY + speed;
          const maxBottom = window.innerHeight - evader.offsetHeight;
          if (newY <= maxBottom) {
            evaderY = newY;
          }
        }
        if (keys.ArrowLeft) {
          newX = evaderX - speed;
          if (newX >= 0) {
            evaderX = newX;
          }
        }
        if (keys.ArrowRight) {
          newX = evaderX + speed;
          const maxRight = window.innerWidth - evader.offsetWidth;
          if (newX <= maxRight) {
            evaderX = newX;
          }
        }

        // Apply the final positions to the element
        evader.style.left = `${evaderX}px`;
        evader.style.top = `${evaderY}px`;

        // (Optional) Call your spawnact function
        if (keys.ArrowUp || keys.ArrowDown || keys.ArrowLeft || keys.ArrowRight) {
          spawnact();
        }

        speedsys.textContent = `1| Speed = ${speed}`;

        requestAnimationFrame(alleyoop);
      }
      alleyoop();
    });

    function finalclickdown() {

      document.getElementById("timerflare").style.display = "none"
      energy.style.display = "none"
      regen.style.display = "none"
      lD.style.display = "none"
      token.style.display = "none"

      lazer = function () { };

      document.getElementById("affected").classList.remove('screenshake')
      document.body.addEventListener('keydown', () => {
        event.stopImmediatePropagation();
      });

      // Use querySelectorAll and forEach to properly hide all elements with the class
      document.querySelectorAll(".flare").forEach(el => {
        el.style.display = "none";
      });
      document.querySelectorAll(".gunner").forEach(el => {
        el.style.display = "none";
      });
      document.querySelectorAll(".laser").forEach(el => {
        el.style.display = "none";
      });

      evader.style.display = "none"
      timershrink.style.display = "none"
      speedsys.style.display = "none"
      document.getElementById("laserball").style.display = "none"
      document.body.style.backgroundColor = "#0A3D22";
      document.getElementById("runner").style.display = "none";
      document.getElementById("sys").style.display = "none";
      document.getElementById("hiddenp").style.display = "block";
      document.getElementById("hidden").style.display = "block";
      document.getElementById("custom").style.display = "block";

      setTimeout(() => {
        document.getElementById("no").style.display = "block";
      }, 500);
      setTimeout(() => {
        document.getElementById("no1").style.display = "block";
      }, 1000);
      setTimeout(() => {
        document.getElementById("no2").style.display = "block";
      }, 1500);
      setTimeout(() => {
        document.getElementById("no3").style.display = "block";
      }, 2000);
      setTimeout(() => {
        document.getElementById("no4").style.display = "block";
      }, 2500);
      setTimeout(() => {
        window.close();
      }, 3000);

    }
    function moverBariable() {

      const rotateInterval = Math.random() * (360 - (-360)) + (-360);
      const sys = document.getElementById("sys")
      const heightControl = window.innerHeight;
      const widthControl = window.innerWidth;
      const elemHite = sys.offsetHeight;
      const elemWith = sys.offsetWidth;

      const yCoord = heightControl - elemHite
      const xCoord = widthControl - elemWith

      const width = Math.random() * xCoord;
      const height = Math.random() * yCoord;

      sys.style.transition = "transform 0.3s ease-in-out, top 0.3s ease-in-out, left 0.3s ease-in-out"

      sys.style.top = height + "px";
      sys.style.left = width + "px";
      sys.style.transform = "rotate(" + rotateInterval + "deg)";

    }
    function hexes() {
      const rawHexInt = Math.floor(Math.random() * 16777215);
      let hexColor = rawHexInt.toString(16);
      hexColor = hexColor.padStart(6, '0');
      return '#' + hexColor;
    }
    const sys = document.getElementById("sys");
    const body = document.body;

    let isOnCooldown = false;
    let mouseX = 0;
    let mouseY = 0;
    document.body.addEventListener("mousemove", () => {
      mouseX = event.clientX;
      mouseY = event.clientY;
    });
let invi = true;
function moveGunner(gunner, angle, speed = 5) {
  let dx = Math.cos(angle) * speed;
  let dy = Math.sin(angle) * speed;

  function updatePosition() {
    const rectx = gunner.getBoundingClientRect();

    let newX = rectx.left + dx;
    let newY = rectx.top + dy;

    // Bounce on left/right
    if (newX <= 0 || newX + rectx.width >= window.innerWidth) {
      dx *= -1; // reverse X direction
      newX = Math.max(0, Math.min(newX, window.innerWidth - rectx.width));
    }

    // Bounce on top/bottom
    if (newY <= 0 || newY + rectx.height >= window.innerHeight) {
      dy *= -1; // reverse Y direction
      newY = Math.max(0, Math.min(newY, window.innerHeight - rectx.height));
    }

    // Apply the new position
    gunner.style.left = `${newX}px`;
    gunner.style.top = `${newY}px`;
    if (invi) {
     if (collision(rect, rectx)) {
       finalclickdown();
     } 
    }


    requestAnimationFrame(updatePosition);
  }

  requestAnimationFrame(updatePosition);
}
function flare(event) {
  if (isOnCooldown) {
    return;
  }
  invi = false;
  isOnCooldown = true;
  
  const rotateInterval2 = Math.random() * (360 - (-360)) + (-360);

  const myFlare = document.createElement('button');
  myFlare.className = 'flare';
  myFlare.style.position = 'absolute';
  myFlare.style.left = rect.left + 'px';
  myFlare.style.top = rect.top + 'px';
  myFlare.style.transform = "rotate(" + rotateInterval2 + "deg)";

  
const gunner = document.createElement("div");
gunner.classList.add("gunner");
document.body.appendChild(gunner);
guns.push(gunner)

// start in center
gunner.style.left = `${rect.left}px`;
gunner.style.top = `${rect.top}px`;

// random facing direction (in radians)
const randomAngle = Math.random() * Math.PI * 2;

// start moving in that direction
moveGunner(gunner, randomAngle, 7); // speed = 7
setTimeout(() => {
  invi = true
}, 200)
setTimeout(() => {
  
  myFlare.style.visibility = "hidden"
}, 300);




document.body.appendChild(myFlare);
setTimeout(() => {
  isOnCooldown = false;
}, 1000);
}


    function spawnact() {
      const newColor = hexes();
      body.style.backgroundColor = newColor;
      document.body.style.transition = "background-color 0.15s ease-in";
      flare(event);
      moverBariable();
    };
    const lasers = [...document.querySelectorAll(".lasertrigger")]

    function lasercollision() {
      const rectervector = evader.getBoundingClientRect();
      lasers.forEach(laser => {

        if (laser.style.display !== "none") {
          const rectL = laser.getBoundingClientRect();
          if (collision(rectervector, rectL)) {
            finalclickdown();

          }
        }
      });
      requestAnimationFrame(lasercollision);
    }
    requestAnimationFrame(lasercollision)
    let tokenspawnx;
    let tokenspawny;
    let tokenX = (window.innerWidth) - 40
    let tokenY = (window.innerHeight) - 40

    function getscreenrandom() {

      tokenspawny = Math.random() * tokenY;
      tokenspawnx = Math.random() * tokenX;
      requestAnimationFrame(getscreenrandom)

    }

    getscreenrandom()

    let execution = false;
    function tokenizer() {

      token = document.createElement('div')

      token.style.position = "absolute"
      token.style.width = "40px"
      token.style.height = "40px"
      token.style.top = tokenspawny + "px";
      token.style.left = tokenspawnx + "px";
      token.style.backgroundColor = "yellow"
      token.style.borderRadius = "100px"
      document.body.appendChild(token)
      function reloadtoken() {
        token1 = token.getBoundingClientRect();
        if (rect.right > token1.left &&
          rect.left < token1.right &&
          rect.bottom > token1.top &&
          rect.top < token1.bottom) {
          points++;
          pointT++;
          if (!execution && points === 5) {
            lazer()
            document.getElementById("timerflare").style.display = "block"
            execution = true;
          }
          if (points === 10) {
            unafk()

          }
          requestAnimationFrame(getscreenrandom)
          token.style.left = tokenspawnx + "px"
          token.style.top = tokenspawny + "px"
          lD.textContent = "Level: " + points

          document.getElementById("affected").classList.add('screenshake')

        } requestAnimationFrame(reloadtoken)
      } requestAnimationFrame(reloadtoken)
    }
    tokenizer()
    let homer;
    function unafk() {
    
      homer = document.createElement("div")
      homer.classList.add("flarhom")
      document.body.appendChild(homer)
      function scannex() {
        homerx = homer.getBoundingClientRect();
        if (collision(rect, homerx)) {
         finalclickdown();
        }
        requestAnimationFrame(scannex)
      } requestAnimationFrame(scannex)

      flarhom.push(homer);
    }
    
    const flarhom = [];
    const flarhomSize = 20;
    const flarhomSpeed = 4;

    function updateHomer() {
      const targetLeftx = rect.left + (rect.width / 2) - (flarhomSize / 2);
      const targetTopx = rect.top + (rect.height / 2) - (flarhomSize / 2);


      for (let i = 0; i < flarhom.length; i++) {
        const el = flarhom[i];
        const currentLeftx = parseFloat(el.style.left) || el.getBoundingClientRect().left;
        const currentTopx = parseFloat(el.style.top) || el.getBoundingClientRect().top;

        const dxx = targetLeftx - currentLeftx;
        const dyx = targetTopx - currentTopx;
        const dist = Math.hypot(dxx, dyx) || 1;
        const stepXx = (dxx / dist) * flarhomSpeed;
        const stepYy = (dyx / dist) * flarhomSpeed;
        el.style.left = (currentLeftx + stepXx) + 'px';
        el.style.top = (currentTopx + stepYy) + 'px';
      }

      requestAnimationFrame(updateHomer);
    }
    requestAnimationFrame(updateHomer)

    
  }//nextINitializeBracket
  nextInitialize()
</script>
